import{_ as w,a as n,c as d,b as t,t as o,w as a,v as p,h as y,F as m,d as V,e as u,m as b,p as v,f as x}from"./index-CZrQt0oH.js";const _={data(){return{vehicles:[],filteredVehicles:[],searchQuery:"",sortKey:"plate",selectedVehicle:null,showWarningPopup:!1,deleteVehiclePopup:!1,vehicleToDelete:null,loading:!0,errorMessage:""}},mounted(){this.fetchVehicles()},methods:{async fetchVehicles(){try{const s=await(await fetch(`https://${GetParentResourceName()}/getVehicles`,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify({})})).json();this.vehicles=s.vehicles,this.filteredVehicles=[...this.vehicles]}catch(e){console.error("Failed to fetch vehicles:",e)}finally{this.loading=!1}},filterVehicles(){const e=this.searchQuery.toLowerCase();this.filteredVehicles=this.vehicles.filter(s=>s.plate.toLowerCase().includes(e)||s.model.toLowerCase().includes(e)||s.name.toLowerCase().includes(e))},sortVehicles(){this.filteredVehicles.sort((e,s)=>e[this.sortKey]<s[this.sortKey]?-1:e[this.sortKey]>s[this.sortKey]?1:0)},addNewVehicle(){this.errorMessage="",this.selectedVehicle={newPlate:"",newModel:"",newOwner:"",name:"",newJob:"",stored:1,isNew:!0}},editVehicle(e){this.errorMessage="",this.selectedVehicle={oldPlate:e.plate,newPlate:e.plate,newModel:e.model,newOwner:e.owner,name:e.name,newJob:e.job,stored:e.stored,isNew:!1}},confirmDeleteVehicle(e){this.vehicleToDelete=e,this.deleteVehiclePopup=!0},async deleteVehicleConfirmed(){if(this.vehicleToDelete)try{const s=await(await fetch(`https://${GetParentResourceName()}/deleteVehicle`,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify({vehicle:this.vehicleToDelete})})).json();if(s.success){const c=this.vehicles.findIndex(h=>h.plate===this.vehicleToDelete.plate);c!==-1&&(this.vehicles.splice(c,1),this.filterVehicles())}else console.error("Failed to delete vehicle:",s.error)}catch(e){console.error("Failed to delete vehicle:",e)}finally{this.closeDeletePopup()}},confirmSaveVehicle(){if(this.errorMessage="",!this.selectedVehicle.newPlate||!this.selectedVehicle.newModel||!this.selectedVehicle.newOwner){this.errorMessage="All fields marked with * are required.";return}if(this.vehicles.find(s=>s.plate===this.selectedVehicle.newPlate&&(!this.selectedVehicle.oldPlate||s.plate!==this.selectedVehicle.oldPlate))){this.errorMessage="A vehicle with this plate already exists.";return}this.selectedVehicle.stored===0?this.showWarningPopup=!0:this.saveVehicle()},async saveVehicle(){this.showWarningPopup=!1;const e=this.selectedVehicle.isNew?"addVehicle":"editVehicle";try{const c=await(await fetch(`https://${GetParentResourceName()}/${e}`,{method:"POST",headers:{"Content-Type":"application/json; charset=UTF-8"},body:JSON.stringify(this.selectedVehicle)})).json();if(c.success){if(this.selectedVehicle.isNew)this.vehicles.push(c.vehicle);else{const h=this.vehicles.findIndex(i=>i.plate===this.selectedVehicle.oldPlate);h!==-1&&this.vehicles.splice(h,1,c.vehicle)}this.filterVehicles(),this.closePopup()}else this.errorMessage="Failed to save vehicle: "+c.error}catch(s){this.errorMessage="An error occurred while saving the vehicle.",console.error("Failed to save vehicle:",s)}},closePopup(){this.selectedVehicle=null,this.errorMessage=""},closeWarningPopup(){this.showWarningPopup=!1},closeDeletePopup(){this.vehicleToDelete=null,this.deleteVehiclePopup=!1}}},g=e=>(v("data-v-6e74c824"),e=e(),x(),e),P={class:"vehicle-management-container"},k={class:"text-2xl font-bold mb-4 text-white"},C={key:0,class:"text-center text-white"},M={key:1},N={class:"filter-search-bar flex justify-between mb-4"},j={value:"plate"},T={value:"model"},D={value:"job"},S={value:"stored"},O={value:"name"},F={class:"overflow-y-auto max-h-[50vh]"},U={class:"min-w-full divide-y divide-gray-200 bg-gray-800 text-white"},B={class:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase tracking-wider"},I={class:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase tracking-wider"},J={class:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase tracking-wider"},W={class:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase tracking-wider"},K={class:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase tracking-wider"},$={class:"px-4 py-2 text-left text-xs font-medium text-gray-300 uppercase tracking-wider"},L={class:"bg-gray-700 divide-y divide-gray-600"},Q={class:"px-4 py-2"},A={class:"px-4 py-2"},G={class:"px-4 py-2"},R={class:"px-4 py-2"},q={class:"px-4 py-2"},E={class:"px-4 py-2"},z=["onClick"],H=["onClick"],X={key:2,class:"popup fixed inset-0 flex items-center justify-center bg-black bg-opacity-75"},Y={class:"popup-content bg-gray-800 text-white p-4 rounded w-1/2"},Z={class:"text-lg font-bold mb-4"},ee={key:0,class:"text-red-500 mb-4"},te={class:"mb-4"},se={class:"block mb-2"},le=g(()=>t("span",{class:"text-red-500"},"*",-1)),oe={class:"mb-4"},ie={class:"block mb-2"},re=g(()=>t("span",{class:"text-red-500"},"*",-1)),ne={class:"mb-4"},de={class:"block mb-2"},ce=g(()=>t("span",{class:"text-red-500"},"*",-1)),ae={class:"mb-4"},he={class:"block mb-2"},pe={class:"mb-4"},ue={class:"block mb-2"},be={value:"1"},ge={value:"0"},ye={class:"mt-4 flex justify-end space-x-2"},fe={key:3,class:"popup fixed inset-0 flex items-center justify-center bg-black bg-opacity-75"},we={class:"popup-content bg-gray-800 text-white p-4 rounded w-1/2"},me={class:"text-lg font-bold mb-4"},Ve={class:"mb-4"},ve={class:"mt-4"},xe={key:4,class:"popup fixed inset-0 flex items-center justify-center bg-black bg-opacity-75"},_e={class:"popup-content bg-gray-800 text-white p-4 rounded w-1/2"},Pe={class:"text-lg font-bold mb-4"},ke={class:"mb-4"},Ce={class:"mt-4 flex justify-end space-x-2"};function Me(e,s,c,h,i,r){return n(),d("div",P,[t("h2",k,o(e.$t("vehicleManagement")),1),i.loading?(n(),d("div",C,o(e.$t("loading"))+"... ",1)):(n(),d("div",M,[t("div",N,[a(t("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>i.searchQuery=l),onInput:s[1]||(s[1]=(...l)=>r.filterVehicles&&r.filterVehicles(...l)),class:"p-2 w-1/3 rounded bg-gray-700 text-white",placeholder:"{{ $t('searchByPlateModelOrName') }}"},null,544),[[p,i.searchQuery]]),a(t("select",{"onUpdate:modelValue":s[2]||(s[2]=l=>i.sortKey=l),onChange:s[3]||(s[3]=(...l)=>r.sortVehicles&&r.sortVehicles(...l)),class:"p-2 rounded bg-gray-700 text-white"},[t("option",j,o(e.$t("sortByPlate")),1),t("option",T,o(e.$t("sortByModel")),1),t("option",D,o(e.$t("sortByJob")),1),t("option",S,o(e.$t("sortByParkedState")),1),t("option",O,o(e.$t("sortByOwnerName")),1)],544),[[y,i.sortKey]])]),t("div",F,[t("table",U,[t("thead",null,[t("tr",null,[t("th",B,o(e.$t("plate")),1),t("th",I,o(e.$t("model")),1),t("th",J,o(e.$t("job")),1),t("th",W,o(e.$t("ownerName")),1),t("th",K,o(e.$t("parked")),1),t("th",$,o(e.$t("actions")),1)])]),t("tbody",L,[(n(!0),d(m,null,V(i.filteredVehicles,(l,Ne)=>(n(),d("tr",{key:l.plate},[t("td",Q,o(l.plate),1),t("td",A,o(l.model),1),t("td",G,o(l.job),1),t("td",R,o(l.name),1),t("td",q,o(l.stored===1?e.$t("yes"):e.$t("no")),1),t("td",E,[t("button",{onClick:f=>r.editVehicle(l),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},o(e.$t("edit")),9,z),t("button",{onClick:f=>r.confirmDeleteVehicle(l),class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"},o(e.$t("delete")),9,H)])]))),128))])])]),t("button",{onClick:s[4]||(s[4]=(...l)=>r.addNewVehicle&&r.addNewVehicle(...l)),class:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600 mt-4"},o(e.$t("addVehicle")),1)])),i.selectedVehicle?(n(),d("div",X,[t("div",Y,[t("h3",Z,o(e.$t(i.selectedVehicle.isNew?"addVehicle":"editVehicle")),1),i.errorMessage?(n(),d("div",ee,o(i.errorMessage),1)):u("",!0),t("div",te,[t("label",se,[b(o(e.$t("plate"))+" ",1),le]),a(t("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=l=>i.selectedVehicle.newPlate=l),class:"w-full p-2 mb-4 border border-gray-300 rounded bg-gray-700 text-white"},null,512),[[p,i.selectedVehicle.newPlate]])]),t("div",oe,[t("label",ie,[b(o(e.$t("model"))+" ",1),re]),a(t("input",{type:"text","onUpdate:modelValue":s[6]||(s[6]=l=>i.selectedVehicle.newModel=l),class:"w-full p-2 mb-4 border border-gray-300 rounded bg-gray-700 text-white"},null,512),[[p,i.selectedVehicle.newModel]])]),t("div",ne,[t("label",de,[b(o(e.$t("ownerIdentifier"))+" ",1),ce]),a(t("input",{type:"text","onUpdate:modelValue":s[7]||(s[7]=l=>i.selectedVehicle.newOwner=l),class:"w-full p-2 mb-4 border border-gray-300 rounded bg-gray-700 text-white",placeholder:"{{ $t('insertOwnerIdentifier') }}"},null,512),[[p,i.selectedVehicle.newOwner]])]),t("div",ae,[t("label",he,o(e.$t("job")),1),a(t("input",{type:"text","onUpdate:modelValue":s[8]||(s[8]=l=>i.selectedVehicle.newJob=l),class:"w-full p-2 mb-4 border border-gray-300 rounded bg-gray-700 text-white",placeholder:"{{ $t('insertJob') }}"},null,512),[[p,i.selectedVehicle.newJob]])]),t("div",pe,[t("label",ue,o(e.$t("parked")),1),a(t("select",{"onUpdate:modelValue":s[9]||(s[9]=l=>i.selectedVehicle.stored=l),class:"w-full p-2 mb-4 border border-gray-300 rounded bg-gray-700 text-white"},[t("option",be,o(e.$t("yes")),1),t("option",ge,o(e.$t("no")),1)],512),[[y,i.selectedVehicle.stored]])]),t("div",ye,[t("button",{onClick:s[10]||(s[10]=(...l)=>r.confirmSaveVehicle&&r.confirmSaveVehicle(...l)),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"},o(e.$t("save")),1),t("button",{onClick:s[11]||(s[11]=(...l)=>r.closePopup&&r.closePopup(...l)),class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},o(e.$t("cancel")),1)])])])):u("",!0),i.showWarningPopup?(n(),d("div",fe,[t("div",we,[t("h3",me,o(e.$t("warning")),1),t("p",Ve,o(e.$t("warningVehicleNotParked")),1),t("div",ve,[t("button",{onClick:s[12]||(s[12]=(...l)=>r.saveVehicle&&r.saveVehicle(...l)),class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"},o(e.$t("proceed")),1),t("button",{onClick:s[13]||(s[13]=(...l)=>r.closeWarningPopup&&r.closeWarningPopup(...l)),class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600 ml-2"},o(e.$t("cancel")),1)])])])):u("",!0),i.deleteVehiclePopup?(n(),d("div",xe,[t("div",_e,[t("h3",Pe,o(e.$t("deleteVehicle")),1),t("p",ke,o(e.$t("confirmDeleteVehicle")),1),t("div",Ce,[t("button",{onClick:s[14]||(s[14]=(...l)=>r.deleteVehicleConfirmed&&r.deleteVehicleConfirmed(...l)),class:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600"},o(e.$t("delete")),1),t("button",{onClick:s[15]||(s[15]=(...l)=>r.closeDeletePopup&&r.closeDeletePopup(...l)),class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"},o(e.$t("cancel")),1)])])])):u("",!0)])}const Te=w(_,[["render",Me],["__scopeId","data-v-6e74c824"]]);export{Te as default};
